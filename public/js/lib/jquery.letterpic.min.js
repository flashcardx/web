!function(t){var e=function(){var t=this;t.colors=["#F44336","#673AB7","#03A9F4","#4CAF50","#FFEB3B","#FF5722","#607D8B","#E91E63","#3F51B5","#00BCD4","#8BC34A","#FFC107","#795548","#9C27B0","#2196F3","#009688","#CDDC39","#FF9800","#9E9E9E"],t.gradients=[["#E57373","#B71C1C"],["#673AB7","#7E57C2"],["#03A9F4","#039BE5"],["#4CAF50","#43A047"],["#FFEB3B","#F57F17"],["#FF5722","#D84315"],["#607D8B","#455A64"],["#E91E63","#C2185B"],["#3F51B5","#303F9F"],["#00BCD4","#0097A7"],["#8BC34A","#689F38"],["#FFC107","#FFA000"],["#795548","#5D4037"],["#9C27B0","#8E24AA"],["#2196F3","#1976D2"],["#009688","#00796B"],["#CDDC39","#AFB42B"],["#FF9800","#F57C00"],["#9E9E9E","#757575"]],t.font="Arial",t.fontColor="#fff",t.fontStrokeColor="#000",t.fontSize=.45,t.imageOverlayColor="rgba(0, 0, 0, 0)",t.maxInitialsLength=2,t.useGlobalCache=!0,t.images=[];for(var e=1;e<=8;e++)t.images.push("patterns/"+e+".png")},i=function(i){function r(t,e,i){function r(t,i){var r;return n.cache[t]||(n.cache[t]={}),n.cache[t][i]?r=n.cache[t][i]:(e.length||(colors=o.bgs.slice().reverse()),r=e.pop(),n.cache[t][i]=r),r}function a(t,e,i,r){var a=i*n.settings.fontSize;e.font=a+"px "+n.settings.font,e.textAlign="center";var o=i/2,l=.45*(a+r);n.settings.fontStrokeColor&&(e.shadowColor=n.settings.fontStrokeColor,e.shadowColor="black",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=3),e.fillStyle=n.settings.fontColor,e.fillText(t,o,l)}var o=this;o.bgs=e;var e=o.bgs.slice().reverse();o.draw=function(e,o,l){var s=r(t.fill,o),c=e[0],f=window.devicePixelRatio,d=f*e.width(),h=f*e.height(),g=c.getContext("2d");g.scale(f,f),e.attr("width",d),e.attr("height",h),i(g,c,s,function(){a(l,g,d,h)}),g.fillStyle=n.settings.imageOverlayColor,g.fillRect(0,0,c.width,c.height)}}var n=this;n.fillTypeColor="color",n.fillTypeGradient="gradient",n.fillTypeImage="image";var a=new e;if(n.settings=t.extend(a,i),n.settings.fill=n.settings.fill||function(t){return t?t.colors?n.fillTypeColor:t.gradients?n.fillTypeGradient:t.images?n.fillTypeImage:n.fillTypeGradient:n.fillTypeGradient}(i),n.settings.useGlobalCache?(window.letterpicCache||(window.letterpicCache={}),n.cache=window.letterpicCache):n.cache={},n.settings.initial)for(var o in n.settings.initial){n.cache[o]||(n.cache[o]={});var l=n.settings.initial[o];for(var s in l)n.cache[o][s]=l[s]}n.drawProviders={},n.drawProviders[n.fillTypeColor]=function(t){return new r(t,t.colors,function(t,e,i,r){t.fillStyle=i,t.fillRect(0,0,e.width,e.height),r()})},n.drawProviders[n.fillTypeGradient]=function(t){return new r(t,t.gradients,function(t,e,i,r){var n=i,a=t.createLinearGradient(0,0,0,e.height);a.addColorStop(0,n[0]);for(var o=1/(n.length-1),l=1;l<n.length-1;l++)a.addColorStop(l*o,n[l]);a.addColorStop(1,n[n.length-1]),t.fillStyle=a,t.fillRect(0,0,e.width,e.height),r()})},n.drawProviders[n.fillTypeImage]=function(t){return new r(t,t.images,function(t,e,i,r){var n=new Image;n.onload=function(){t.drawImage(n,0,0,e.width,e.height),r()},n.src=i})},n.drawProvider=n.drawProviders[n.settings.fill](n.settings)};t.fn.letterpic=function(e){function r(t){return t.data().letterpicKey||t.data().letterpicUserId||t.data().userid||n(t)}function n(t){for(var e=t.attr("title").split(" "),i=e[0].charAt(0).toUpperCase(),r=1;r<s.settings.maxInitialsLength;r++)e.length>r&&(i+=e[r].charAt(0).toUpperCase());return i}function a(t){return!(!t.complete||void 0!==t.naturalWidth&&0===t.naturalWidth)}function o(e){var i=t(e.target);i.off("error",o),l(i)}function l(e){var i;e.is("canvas")?i=e:(i=t("<canvas></canvas>"),t.each(e[0].attributes,function(t,e){i.attr(e.name,e.value)}),e.replaceWith(i));var a=r(i),o=n(i);s.drawProvider.draw(i,a,o)}var s=new i(e);this.each(function(){var e=t(this);e.is("img")&&a(e[0])?e.on("error",o):l(e)})}}(jQuery);